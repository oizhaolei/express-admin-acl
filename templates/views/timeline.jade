extends ../layouts/default
include ../mixins/upload
block css
  link(href='//file.tttalk.org/public/blueimp-file-upload/css/jquery.fileupload.css', rel='stylesheet')

block content
  h1.bigPageTitle Timeline
  script#waterfall-tpl(type="text/x-handlebars-template")
    | {{#each this}}
    .item
      a.photo(href="/user_photos/{{_id}}")
        img(src="http://file.tttalk.org/bmiddle/{{pic_url}}" width="240" height="240")
      a.avatar(href="/users/{{user_id}}")
        img.img-circle(src="http://file.tttalk.org/thumbnail/{{user_pic}}" width="40" height="40")
      | {{fullname}}
      | {{user_id}}
      p {{content}}
      p {{to_content}}
    | {{/each}}

  #container(style="width: 1000px; margin: 0 auto;")

  +photo-upload-dialog
block page-js
  //- scripts
  script(type='text/javascript').
    var entry_point = '/api/user_photos/timeline';

  if !user
    script(type='text/javascript').
      $('document').ready(function () {
        $(".author-link").click(function(e){
          $("#loginModal").modal();
          return false;
        });
      });
  script(src='/js/views/index.js')


  script(src='//file.tttalk.org/public/blueimp-file-upload/js/vendor/jquery.ui.widget.js')

  script(src='//file.tttalk.org/public/blueimp-file-upload/js/jquery.iframe-transport.js')
  script(src='//file.tttalk.org/public/blueimp-file-upload/js/jquery.fileupload.js')
  script(src='//blueimp.github.io/JavaScript-Load-Image/js/load-image.all.min.js')
  script(src='//blueimp.github.io/JavaScript-Canvas-to-Blob/js/canvas-to-blob.min.js')

  script(src='//file.tttalk.org/public/blueimp-file-upload/js/jquery.iframe-transport.js')
  script(src='//file.tttalk.org/public/blueimp-file-upload/js/jquery.fileupload.js')
  script(src='//file.tttalk.org/public/blueimp-file-upload/js/jquery.fileupload-process.js')
  script(src='//file.tttalk.org/public/blueimp-file-upload/js/jquery.fileupload-image.js')
  script(src='//file.tttalk.org/public/blueimp-file-upload/js/jquery.fileupload-audio.js')
  script(src='//file.tttalk.org/public/blueimp-file-upload/js/jquery.fileupload-video.js')
  script(src='//file.tttalk.org/public/blueimp-file-upload/js/jquery.fileupload-validate.js')

  script(src='/js/views/upload.js')
